USE [AdventureWorks2014]
GO
use SalesLT

--q1
 use SalesLT
 select aw.CustomerID, ad.* from Address as ad INNER JOIN CustomerAddress as ca ON ad.AddressId=ca.AddressId  inner join Customer aw on ca.CustomerId=aw.CustomerID  where aw.CompanyName ='Modular Cycle Systems';
 
 --q2 ans
 select p.ProductID,p.Name,p.ListPrice,sod.OrderQty from  SalesOrderHeader as soh inner join SalesOrderDetail as sod on sod.SalesOrderID=soh.SalesOrderID inner join Product  as p on sod.ProductID=p.ProductID where soh.CustomerID=29660; 
 

 /*q3 ans*/
select aw.FirstName,aw.CompanyName,aw.CustomerID from Address as ad INNER JOIN CustomerAddress as ca ON ad.AddressId=ca.AddressId  inner join Customer aw on ca.CustomerId=aw.CustomerID  where ad.City='dallas';
 /*q4 ans*/
 
select  aw.CustomerID,aw.CompanyName from Customer as aw where aw.CustomerID in (select sod.CustomerID  from SalesOrderHeader  as sod group by (sod.CustomerID)having sum(sod.Freight+sod.SubTotal+sod.TaxAmt)>100000);
 /*q5 ans*/

select sod.SalesOrderID,sod.UnitPrice  from SalesOrderHeader soh inner join SalesOrderDetail sod on sod.SalesOrderID=soh.SalesOrderID and soh.CustomerID in (select soh.CustomerID from SalesOrderHeader soh group by soh.CustomerID having(count(*)=1));
/*q6 ans*/
select aw.companyname,aw.CustomerID from ProductModel pm inner join Product p on p.ProductID=pm.ProductModelID inner join SalesOrderDetail sod on p.ProductID=sod.ProductID inner join SalesOrderHeader soh on sod.SalesOrderID=soh.SalesOrderID inner join Customer aw on aw.CustomerID=soh.CustomerID where pm.Name='Racing Socks';
/*q8*/
select sum(soh.Freight+soh.SubTotal+soh.TaxAmt) from address a inner join CustomerAddress ca on a.addressid=ca.addressid inner join SalesOrderHeader soh on ca.customerid=soh.CustomerID group by a.CountryRegion;
/*q7*/
select count(*)
from Address as a inner join CustomerAddress ca on a.AddressID = ca.AddressID
inner join SalesOrderHeader as soh on ca.CustomerID = soh.CustomerID
inner join SalesOrderDetail as sod on sod.SalesOrderID = soh.SalesOrderID
inner join Product as p on sod.ProductID = p.ProductID
inner join ProductCategory as pc on pc.ProductCategoryID = p.ProductCategoryID
where a.City LIKE 'London' and pc.Name='Cranksets'