<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
<meta charset="ISO-8859-1">
<title>ChatBoard</title>
<style type="text/css">
#MESSAGES {
	float: left;
	width: 50%;
	left: 15%;
	height: 500px;
	border-style: solid;
	border-width: 1px;
}
#ACTIVEUSERS {
	float: left;
	width: 20%;
	margin-left: 8px;
	height: 500px;
	border-style: solid;
	border-width: 1px;
}
</style>

<script type="text/javascript">
	var lastMsgId = 0;
	function getNewXmlHttp() {
		var xmlhttp;
		if (window.XMLHttpRequest) {
			xmlhttp = new XMLHttpRequest();
		} else {
			xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
		}
		return xmlhttp;
	}
	function sendMessage() {
		var xmlhttp = getNewXmlHttp();
		var message = document.getElementById("message").value;
		xmlhttp.onreadystatechange = function() {
			if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
			
				var text = xmlhttp.responseText;
				document.getElementById("MESSAGES").innerHTML = text;
				//console.log(text);
			}
		}
		
		var parameters = "message="+message;
		
		xmlhttp.open("POST",
				"http://localhost:8080/ChatBoard/SendMessage", true);
		xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
		xmlhttp.send(parameters);
	}
	
	
	
	function newMessage(){
		var xmlhttp = getNewXmlHttp();
		
		xmlhttp.onreadystatechange = function() {
			if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
				var text = xmlhttp.responseText;
				console.log(text);
			
			}
		}
		
		var parameters = "id="+lastMsgId;
		
		xmlhttp.open("POST",
				"http://localhost:8080/ChatBoard/getMessage", true);
		xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
	
	}
	window.setInterval(sendMessage(),123);
</script>

</head>
<body>
	<div id="MESSAGES">Message Box</div>
	<div id="ACTIVEUSERS">List of Active users</div>
	<div style="clear: both;" id="messageBox">
		<textarea rows="5" cols="40" id="message"
			style="border-style: solid; border-width: 2px; margin-top: 3px;"></textarea>
		<br/>
		<button name="send" value="send" onclick="sendMessage();">send</button><br/>
		
	</div>

</body>
</html>